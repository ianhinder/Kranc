---
---

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
        "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
<title>Kranc Tutorial</title>
{% include preamble.html %}
</head>
  
<body id="tutorial">
{% include header.html %}

<h2>Kranc Tutorial</h2>

<p>This tutorial is in four parts.  The first part describes how to
download and configure Cactus, and can be skipped if you are already
familiar with Cactus and have an existing Cactus installation that you
want to use.  The second part describes how to download and install
Kranc into your Cactus installation. The third part describes how to
generate the SimpleWave example thorn and compile it.  The fourth part
describes how to run the example and analyse the output.</p>

<p>Prerequisites:</p>
<ul>
<li>Mathematica</li>
<li>A C and C++ compiler</li>
<li>The <a href = "http://git-scm.com/">Git</a> version control system</li>
<li>The <a href = "http://subversion.apache.org/">Subversion</a> version control system</li>
<li>A Unix-type operating system (e.g. Linux or Mac OS)
</ul>

<h2>Download and install Cactus</h2>

<p>The first step is to create a Cactus directory. Everything will
then be downloaded into this directory and compiled there.

<pre>
mkdir Cactus
cd Cactus
</pre>

<p>Download the Cactus <i>GetComponents</i> script and make it
executable. This script allows you to download Cactus thorns from many
different repositories listed in a <i>ThornList</i>.

<pre>
curl -kLO https://raw.githubusercontent.com/gridaphobe/CRL/master/GetComponents
chmod u+x GetComponents
</pre>

<p>Download Cactus:

<pre>./GetComponents -a --root=. http://kranccode.org/ComputationalToolkitBasic.th</pre>

<p>After several minutes, Cactus should have been downloaded.</p>

<h2>Install Kranc into your Cactus directory</h2>

<p>Download the Kranc distribution (you will need the <i>git</i>
version control program installed):</p>

<!-- <pre> -->
<!-- wget http://github.com/ianhinder/Kranc/tarball/master -->
<!-- tar xfz *-Kranc-*.tar.gz -->
<!-- mv *-Kranc-* Kranc -->
<!-- </pre> -->

<pre>git clone https://github.com/ianhinder/Kranc</pre>

<p>Link Kranc into your Cactus installation:</p>
<pre>
ln -s ../Kranc/Auxiliary/Cactus/KrancNumericalTools arrangements/KrancNumericalTools
ln -s ../Kranc/Examples arrangements/KrancExamples
</pre>

<p>Kranc is now installed and ready to use.</p>

<h2>Build the SimpleWave example</h2>

<p>Go into the Examples directory and run Kranc to build the SimpleWave thorn:</p>

<pre>
cd Kranc/Examples
../../Kranc/Bin/kranc SimpleWave.m
</pre>

<p>There should be a new directory, SimpleWave, which is the Cactus
thorn which has been newly generated from the SimpleWave.m Kranc
script.</p>

<p>Return to the Cactus directory and copy the example Cactus thornlist:</p>
<pre>
cd ../..
cp ComputationalToolkitBasic.th kranc.th</pre>

<p>Add KrancNumericalTools/GenericFD and KrancExamples/SimpleWave to
kranc.th using a text editor or the following command::</p>
<pre>
echo 'KrancNumericalTools/GenericFD
KrancExamples/SimpleWave' >> kranc.th
</pre>

<p>Create a Cactus configuration called "kranc" using this thornlist:</p>
<pre>
make kranc-config THORNLIST=kranc.th PROMPT=no
</pre>

<p>If a C compiler cannot be found, or there is some other error,
consult the <a href = "http://cactuscode.org/documentation">Cactus
documentation</a> for advice on configuring Cactus for your system.
You may have to write an <i>optionlist</i> for your system and use it
in the "make kranc-config" line.</p>

<p>The configuration containing the Kranc-generated thorn should now
have been built.  The executable will be exe/cactus_kranc and the
intermediate build files will be in configs/kranc.</p>

<h2>Run the SimpleWave example</h2>

<p>Run Cactus with the parameter file simplewave_sine.par:</p>

<pre>
cd Kranc/Examples
../../exe/cactus_kranc simplewave_sine.par
</pre>

<p>You should see many lines of output as Cactus runs.  If the test
finishes successfully, the final line should be "Done."</p>

<p>
The output will be in the directory simplewave_sine.  The variable phi
is stored as a 1D timeseries in simplewave_sine/phi.xl.  The output
file is a simple text file which can be visualised in Mathematica
using the provided Analysis.nb notebook, or in the <a href =
"http://cactuscode.org/documentation/visualization/yGraph/">ygraph</a>
animation tool.</p>

<p>To visualise the output in Mathematica, open the notebook
"Analysis.nb", provided in the Examples directory, and choose
Evaluation -> Evaluate Notebook.</p>

<p>You should see a sine wave.  Use the Manipulate slider to animate
the display to see the different iterations of the simulation.</p>

<div><img src="sineplot.png" alt="Plot of sine wave"></div>

</body>
</html>
